<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Debounce QUnit Tests</title>
  <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-git.css">
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="debounce.js"></script>
  <script src="http://code.jquery.com/qunit/qunit-git.js"></script>
  <script>

	test( "Variable", function() {
	  ok( typeof debounce !== "undefined", "Variable Defined" );
	  ok( typeof debounce.version !== "undefined", "With Version" );
	} );

	asyncTest( "Timeout Schedule", function() {
		expect( 1 );
		debounce( 'test', 10, function() {
			ok( true, "schedule with 10ms delay" );
		} );
		setTimeout( start, 15 );
	} );
	
	asyncTest( "Interval Schedule", function() {
		expect( 1 );
		var stack = [];
		debounce( 'test', 10, function() {
			stack.push('');
			return stack.length < 3;
		} );
		setTimeout( function() {
			equal( stack.length, 3, 'Interval run 3 times' );
			start();
		}, 35 );
	} );
	
	asyncTest( "Interval Schedule with variable delays", function() {
		expect( 2 );
		var i = 0;
		debounce( 'test', 10, function() {
			++ i;
			return i > 2 ? false : i * 10;
		} );
		setTimeout( function() {
			equal( i, 2, 'Interval run with different delays' );
		}, 25 );
		setTimeout( function() {
			equal( i, 3, 'Interval run with different delays' );
			start();
		}, 45 );
	} );
	
	asyncTest( "Override (debounce)", function() {
		expect( 1 );

		debounce( 'test', 100, function() {
			ok( false, 'override failed' );
		} );
		setTimeout( function() {
			debounce( 'test', 100, function() {
				ok( true, 'override passed' );
			} );
		}, 20 );
		setTimeout( function() {
			start();
		}, 125 );
	} );

	asyncTest( "Force run", function() {
		expect( 1 );

		var test = function() {
			ok( true, '' );
		};

		debounce( 'test', 100, test );

		setTimeout( function() {
			debounce( 'test', true );
		}, 20 );

		setTimeout( function() {
			start();
		}, 105 );
	} );

	asyncTest( "Cancel", function() {
		expect( 0 );

		var test = function() {
			ok( true, '' );
		};

		debounce( 'test', 100, test );

		setTimeout( function() {
			debounce( 'test' );
		}, 20 );

		setTimeout( function() {
			start();
		}, 105 );
	} );

  </script>
</body>
</html>